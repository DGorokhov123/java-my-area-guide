# My Area Guide

My Area Guide - web-приложение, Афиша локальных событий.
Приложение предназначено для людей, которые хотят быть на связи с местным сообществом, следить за новыми событиями
и принимать в них участие.

- Пользователи могут просматривать списки событий, отправлять заявки на участие, получать подтверждения или отказы,
оставлять комментарии и лайки.
- Организаторы могут создавать новые события и управлять списками участников
- Администраторы могут управлять событиями, пользователями, категориями, комментариями и создавать подборки событий.

Приложение работает в связке с рекомендательной системой
[Recommend Me More](https://github.com/DGorokhov123/java-collaborative-filtering).
Эта система может давать пользователям индивидуальные рекомендации на основании истории пользовательского поведения, 
подбирать похожие события и ранжировать события по популярности.

В приложении используется микросервисная архитектура, построенная по принципам DDD.
Микросервисы построены вокруг 4 базовых типов сущностей:
- Пользователи (модуль **_user-service_**)
- События (модуль **_event-service_**)
- Заявки (модуль **_request-service_**)
- Комментарии (модуль **_comment-service_**)

Взаимодействие микросервисов между собой осуществляется с помощью REST-контроллеров и Feign-клиентов, 
имплементирующих общие API-интерфейсы, что обеспечивает гарантию совместимости API.
Приложение использует Spring Eureka Discovery для управления инстансами микросервисов, а также Spring Cloud Gateway
для доступа к системе извне. Эти технологии обеспечивают балансировку нагрузки между микросервисами как для внешних 
вызовов (через Gateway), так и для внутренних (через Feign-клиенты). Также Service Discovery используется для интеграции
приложения с микросервисами рекомендательной системы.

# Инфраструктурные модули (папка `/infra`)

Используются:
- String Boot
- Spring Cloud Eureka server
- Spring Cloud Config server
- Spring Cloud Gateway server

## Discovery Service

Модуль **discovery-server** реализует Service Registry - центральный управляющий модуль, обеспечивающий
взаимодействие между микросервисами, load balancing, multi-instance, health-checks и т.д.

## Configuration Service

Модуль **config-server** реализует паттерн External Configuration в качестве центрального хранилища конфигураций 
для всех микросервисов, кроме **discovery-server**.

## Gateway Service

Модуль **gateway-server** реализует паттерн API Gateway.
Он работает как единая точка входа извне для всех микросервисов.

# Модули основного приложения (папка `/core`)

Приложение состоит из 4 интегрированных микросервисов. Каждый микросервис работает с отдельной базой данных 
(для упрощения в данном релизе реализованы как разные схемы в единой бд). 
Взаимодействие осуществляется посредством Feign-клиентов с поддержкой circuit breaker на базе Resilience4j.

Используются:
- Java ٩(◕‿◕｡)۶
- String Boot
- Spring MVC (REST)
- Spring Data JPA (Hibernate)
- Spring Cloud Discovery and Configuration
- OpenFeign client + Resilience4j
- PostgreSQL

## Модуль общей библиотеки

Модуль **core-common** содержит общие классы и интерфейсы, используемые в разных модулях, в частности:
- Интерфейсы описания API
- Вспомогательные классы Feign-клиентов
- DTO
- Исключения и обработчики исключений
- Кастомные валидаторы и аннотации.

## Сервис управления пользователями `user-service`

Микросервис **user-service** предоставляет интерфейс администратора для управления пользователями.
Он не обращается к другим сервисам, но предоставляет им информацию о пользователях.

Спецификация внешнего API: [API-user-service-specification.json](API-user-service-specification.json)

API межсервисного взаимодействия:
- GET /admin/users/{userId}/short (возвращает UserShortDto с базовой информацией)
- GET /admin/users/all/short (возвращает список UserShortDto)
- GET /admin/users/all/full (возвращает список UserDto с полной информацией)

## Сервис управления событиями `event-service`

Микросервис **event-service** предоставляет приватный, публичный и администраторский API для управления событиями - 
центральной сущностью в приложении. Сервис взаимодействует с другими сервисами: 
- **request-service** (запрашивает информацию о количестве заявок на участие в событии) 
- **user-service** (запрашивает расширенную информацию о пользователе)

Спецификация внешнего API: [API-event-service-specification.json](API-event-service-specification.json)

API межсервисного взаимодействия:
- GET /events/{id}/dto/interaction (возвращает объект данных EventInteractionDto с информацией о событии)
- GET /events/{id}/dto/comment (возвращает сокращенный объект EventCommentDto для сервиса комментариев)
- POST /events/dto/list/comment (возвращает список EventCommentDto для сервиса комментариев)

## Сервис управления заявками `request-service`

Микросервис **request-service** предоставляет пользовательский интерфейс для управления заявками на участие в событиях.
Он обращается к сервисам **event-service** and **user-service** для получения расширенной информации о сущностях, а 
также проверок их существования.

Спецификация внешнего API: [API-request-service-specification.json](API-request-service-specification.json)

API межсервисного взаимодействия:
- POST /requests/confirmed (возвращает Map количеств подтвержденных заявок для списка ID событий)

## Сервис управления комментариями `comment-service`

Микросервис **comment-service** предоставляет администраторский, приватный и публичный интерфейсы для управления
комментариями к событиям.
Он обращается к сервисам **event-service** and **user-service** для получения расширенной информации о сущностях, а
также проверок их существования.

Спецификация внешнего API: [API-comment-service-specification.json](API-comment-service-specification.json)

# Модули рекомендательной системы (папка `/stats`)

Модуль **stats-client** содержит клиентский интерфейс для взаимодействия с рекомендательно системой
[Recommend Me More](https://github.com/DGorokhov123/java-collaborative-filtering).
Клиент использует gRPC+Protobuf для взаимодействия с микросервисами рекомендательной системы. 

Модуль **proto-schemas** содержит .proto файлы с описанием протокола и автоматически генерируемые Java-классы, 
используемые gRPC-клиентом.

